<!DOCTYPE HTML>
<html ng-app>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">    
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="assets/css/snackbar.min.css" rel="stylesheet" />
    <link href="assets/css/mobile.css" rel="stylesheet" />
    <link href="assets/css/fine.css" rel="stylesheet" />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style type="text/css">
        .contentImage > img {
            width: 50%;
            padding: 0px 5px;
        }
    </style>
  </head>

  <body onload="init()">
    <div class="row" style="margin-left: 0;margin-right: 0;">
      <div class="col-xs-12 headerLogo"style="margin: 30px 0 40px 0;">
        <div class="col-xs-6">
          <img src="assets/img/sspm_logo.png" class="img img-responsive headerImg" style="width: 120px;margin-top: 25px;" alt="logo" />
        </div>
        <div class="col-xs-6">
          <p class="headerText">
            Sistema de Control de
            <span style="color: rgba(0, 23, 52, 0.8);font-size: 24px;font-weight: 600;"> Infracciones de Transito</span>
          </p>
        </div>
      </div> 

      <div class="container">
        <div class="stepwizard">
            <div class="stepwizard-row setup-panel">
                <div class="stepwizard-step">
                    <a href="#step-1" type="button" class="btn btn-primary btn-circle"></a>
                    <p>Automovilista</p>
                </div>
                <div class="stepwizard-step">
                    <a href="#step-2" type="button" class="btn btn-default btn-circle" disabled="disabled"></a>
                    <p>Vehiculo</p>
                </div>
                <div class="stepwizard-step">
                    <a href="#step-3" type="button" class="btn btn-default btn-circle" disabled="disabled"></a>
                    <p>Infracción</p>
                </div>
                <div class="stepwizard-step">
                    <a href="#step-4" type="button" class="btn btn-default btn-circle" disabled="disabled"></a>
                    <!--p>Fotografías</p--><p>Generar</p>
                </div>
            </div>
        </div>
        <form class="form col-xs-12" role="form" id="formFine" enctype="multipart/form-data">
            <div class="row setup-content" id="step-1">
                <div class="col-xs-12">
                    <div class="col-md-12">
                        <h3>Automovilista</h3>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Nombre completo</label> 
                            <input type="text" ng-model="fullName" name="fullName" id="fullName" class="form-control inputShadow" placeholder="Nombre completo del conductor" maxlength="55" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Tipo de licencia</label>
                            <input type="text" ng-model="typeLicense" name="typeLicense" id="typeLicense" class="form-control inputShadow" placeholder="Tipo de licencia del conductor" maxlength="25" list="typeLicenseList" required />
                            <datalist id="typeLicenseList"></datalist>
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Número de licencia</label>
                            <input type="text" ng-model="numberLicense" name="numberLicense" id="numberLicense" class="form-control inputShadow" placeholder="Número de licencia del conductor" maxlength="25" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Fecha de expedición</label>
                            <input type="date" ng-model="dateStart" name="dateStart" id="dateStart" class="form-control inputShadow" placeholder="Fecha de expedición de la licencia del conductor" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Fecha de vencimiento</label>
                            <input type="date" ng-model="dateEnd" name="dateEnd" id="dateEnd" class="form-control inputShadow" placeholder="Fecha de vencimiento de la licencia del conductor" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Sexo</label>
                            <select ng-model="gender" name="gender" id="gender" class="form-control inputShadow" required>
                              <option value="">Sexo del conductor</option>
                              <option value="M">MASCULINO</option>
                              <option value="F">FEMENINO</option>
                            </select>
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Fecha de nacimiento</label>
                            <input type="date" ng-model="birthday" name="birthday" id="birthday" class="form-control inputShadow" placeholder="Fecha de nacimiento del conductor" required />
                        </div>
                        <div class="form-group col-xs-12 col-sm-8">
                            <label class="control-label">Dirección</label>
                            <input type="text" ng-model="address" name="address" id="address" class="form-control inputShadow" placeholder="Dirección del conductor" maxlength="225" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Estado</label>
                            <input type="text" ng-model="state" name="state" id="state" class="form-control inputShadow" placeholder="Estado de procedencia del conductor" maxlength="55" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Municipio</label>
                            <input type="text" ng-model="city" name="city" id="city" class="form-control inputShadow" placeholder="Ciudad de procedencia del conductor" maxlength="55" required />
                        </div>
                        <div class="clearfix"></div>
                        <div class="form-group col-xs-2 col-xs-offset-5 text-center">
                          <button class="btn btn-primary nextBtn" type="button">
                            <img src="assets/img/arrow.png" width="24" />
                          </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row setup-content" id="step-2">
                <div class="col-xs-12">
                    <div class="col-md-12">
                        <h3>Vehiculo</h3>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">VIN</label> 
                            <input type="text" ng-model="vinVehicle" name="vinVehicle" id="vin" class="form-control inputShadow" placeholder="Número de identificación del vehiculo" maxlength="55" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Tipo de vehiculo</label> 
                            <input type="text" ng-model="typeVehicle" name="typeVehicle" id="typeVehicle" class="form-control inputShadow" placeholder="Tipo de vehiculo" maxlength="55" list="typeVehicleList" required />
                            <datalist id="typeVehicleList"></datalist>
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Tipo de placa</label> 
                            <input type="text" ng-model="typePlate" name="typePlate" id="typePlate" class="form-control inputShadow" placeholder="Tipo de placa del vehiculo" maxlength="25" list="typePlateList" required />
                            <datalist id="typePlateList"></datalist>
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Placa</label> 
                            <input type="text" ng-model="plateVehicle" name="plateVehicle" id="plateVehicle" class="form-control inputShadow" placeholder="Placa del vehiculo" maxlength="25" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Estado del vehiculo</label> 
                            <input type="text" ng-model="statusVehicle" name="statusVehicle" id="statusVehicle" class="form-control inputShadow" placeholder="Estado del vehiculo" maxlength="125" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Marca</label> 
                            <input type="text" ng-model="brandVehicle" name="brandVehicle" id="brandVehicle" class="form-control inputShadow" placeholder="Marca del vehiculo" maxlength="55" list="brandVehicleList" required />
                            <datalist id="brandVehicleList"></datalist>
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Modelo</label> 
                            <input type="number" ng-model="modelVehicle" name="modelVehicle" id="modelVehicle" class="form-control inputShadow" placeholder="Modelo del vehiculo" pattern="[0-9]{4}" size="4" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Linea</label> 
                            <input type="text" ng-model="lineVehicle" name="lineVehicle" id="lineVehicle" class="form-control inputShadow" placeholder="Linea del vehiculo" maxlength="55" list="lineVehicleList" required />
                            <datalist id="lineVehicleList"></datalist>
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Color</label> 
                            <input type="text" ng-model="colorVehicle" name="colorVehicle" id="colorVehicle" class="form-control inputShadow" placeholder="Color del vehiculo" maxlength="55" list="colorVehicleList" required />
                            <datalist id="colorVehicleList"></datalist>
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Servicio</label> 
                            <input type="text" ng-model="serviceVehicle" name="serviceVehicle" id="serviceVehicle" class="form-control inputShadow" placeholder="Servicio del vehiculo" maxlength="55" list="serviceVehicleList" required />
                            <datalist id="serviceVehicleList"></datalist>
                        </div>
                        <div class="clearfix"></div>
                        <div class="form-group col-xs-2 col-xs-offset-5 text-center">
                          <button class="btn btn-primary nextBtn" type="button">
                            <img src="assets/img/arrow.png" width="24" />
                          </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row setup-content" id="step-3">
                <div class="col-xs-12">
                    <div class="col-md-12">
                        <h3>Infracción</h3>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Número de boleta</label> 
                            <input type="text" ng-model="numberFine" name="numberFine" id="numberFine" class="form-control inputShadow" placeholder="Número de boleta de infracción" maxlength="55" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Número de recibo</label> 
                            <input type="text" ng-model="billFine" name="billFine" id="billFine" class="form-control inputShadow" placeholder="Número de recibo de infracción" maxlength="55" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Dirección</label> 
                            <input type="text" ng-model="addressFine" name="addressFine" id="addressFine" class="form-control inputShadow" placeholder="Dirección de la infracción" maxlength="225" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Garantía</label> 
                            <input type="text" ng-model="warrantyFine" name="warrantyFine" id="warrantyFine" class="form-control inputShadow" placeholder="Garantía de la infracción" maxlength="55" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Estatus</label> 
                            <input type="text" ng-model="statusFine" name="statusFine" id="statusFine" class="form-control inputShadow" placeholder="Estatus de la infracción" maxlength="55" value="PENDIENTE" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Distrito</label> <!-- iDistrito - BD --> 
                            <input type="text" ng-model="districtFine" name="districtFine" id="districtFine" class="form-control inputShadow" placeholder="Distrito de la infracción" maxlength="25" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Oficial</label> <!-- iOficial - BD -->  
                            <input type="text" ng-model="oficcerFine" name="oficcerFine" id="oficcerFine" class="form-control inputShadow" placeholder="Oficial de la infracción" maxlength="55" required />
                        </div>
                        <div class="form-group col-xs-6 col-sm-4">
                            <label class="control-label">Artículo</label> <!-- iArticulo - BD -->  
                            <input type="text" ng-model="articleFine" name="articleFine" id="articleFine" class="form-control inputShadow" placeholder="Artículo de la infracción" maxlength="55" required />
                        </div>
                        <div class="clearfix"></div>
                        <div class="form-group col-xs-2 col-xs-offset-5 text-center">
                          <button class="btn btn-primary nextBtn" type="button">
                            <img src="assets/img/arrow.png" width="24" />
                          </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row setup-content" id="step-4">
              <div class="col-xs-12">
                <div class="col-md-12">
                  <h3>Fotografías</h3><!--h3>Generar infracción</h3-->
                  <div class="form-group col-xs-6">
                    <!--span class="btn-file grid-file">
                      <p style="text-align: center;margin-top: 60px;">Selecciona las imagenes</p>
                      <input type="file" capture="camera" name="photo[]" accept="image/*" id="takePicture" multiple />
                    </span-->
                    <button type="button" class="btn btn-info" onclick="capturePhoto();" style="display: inline-block;">Tomar una fotografía</button>
                    <button type="button" class="btn btn-warning" onclick="getPhoto(pictureSource.PHOTOLIBRARY);" style="display: inline-block;">Buscar en dispositivo</button>
                  </div>
                  <!--div class="col-xs-12">
                      <div class="panel panel-info well-card">
                        <div class="panel-heading">
                          <h3 class="panel-title">
                            <span class="name">{{ fullName }}</span></span>
                          </h3>
                        </div>
                        <div class="panel-body">
                          <div class="row">
                            <div class="col-xs-12"> 
                              <table class="table table-user-information">

                                <tbody>
                                  <tr>
                                    <td><strong>Número de boleta</strong><br/>{{ numberFine }}</td>
                                    <td><strong>Número de artículo</strong><br/>{{ articleFine }}</td>
                                    <td><strong>Fecha de infracción</strong><br/>{{ date | date:'yyyy-MM-dd' }}</td>
                                  </tr>
                                  <tr>
                                    <td><strong>Número de licencia</strong><br/>{{ numberLicense }}</td>
                                    <td><strong>Tipo de licencia</strong><br/>{{ typeLicense }}</td>
                                    <td><strong>Fecha de expedición</strong>{{ dateStart }}</td>
                                  </tr>
                                  <tr>
                                      <td><strong>Sexo</strong><br/>{{ gender }}</td>
                                      <td><strong>Fecha de nacimiento</strong><br/>{{ birthday }}</td>
                                      <td><strong>Fecha de vencimiento</strong><br/>{{ dateEnd }}</td>
                                  </tr>
                                  <tr>
                                      <td><strong>Estado</strong><br/>{{ state }}</td>
                                      <td><strong>Municipio</strong><br/>{{ city }}</td>
                                      <td><strong>Dirección</strong><br/>{{ address }}</td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                        </div>
                        <div class="panel-body" style="margin-top: -15px;">
                            <div class="row">
                              <div class="col-xs-12"> 
                                <table class="table table-user-information">
                                  <tbody>
                                    <tr>
                                      <td><strong>Tipo de placa</strong><br/>{{ typePlate }}</td>
                                      <td><strong>Tipo de vehiculo</strong><br/>{{ typeVehicle }}</span></td>
                                      <td><strong>Placa</strong><br/>{{ plateVehicle }}</td>
                                    </tr>
                                    <tr>
                                      <tr>
                                        <td><strong>Marca</strong><br/>{{ brandVehicle }}</span></td>
                                        <td><strong>Modelo</strong><br/>{{ modelVehicle }}</span></td>
                                        <td><strong>Linea</strong><br/>{{ lineVehicle }}</td>
                                      </tr>
                                      <tr>
                                        <td><strong>VIN</strong><br/>{{ vinVehicle }}</td>
                                        <td><strong>Color</strong><br/>{{ colorVehicle }}</span></td>
                                      </tr>
                                      <tr>
                                        <td><strong>Servicio</strong><br/>{{ serviceVehicle }}</span></td>
                                        <td><strong>Estado</strong><br/>{{ statusVehicle }}</span></td>
                                      </tr>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                        </div>
                        <div class="panel-body" style="margin-top: -15px;">
                            <div class="row">
                              <div class="col-xs-12"> 
                                <table class="table table-user-information">
                                  <tbody>
                                    <tr>
                                      <td><strong>Número de recibo</strong><br/>{{ billFine }}</td>
                                      <td><strong>Garantía</strong><br/>{{ warrantyFine }}</span></td>
                                      <td><strong>Estatus</strong><br/>{{ statusFine }}</td>
                                    </tr>
                                    <tr>
                                      <tr>
                                        <td><strong>Distrito</strong><br/>{{ districtFine }}</span></td>
                                        <td><strong>Oficial</strong><br/>{{ oficcerFine }}</span></td>
                                        <td><strong>Dirección</strong><br/>{{ addressFine }}</td>
                                      </tr>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                        </div>

                      </div>
                  </div-->                        
                  <input type="hidden" id="latitude" name="latitud" />
                  <input type="hidden" id="longitude" name="latitud" />
                  <!--input type="hidden" id="texta" name="photo" style="text-transform: none;" /-->
                  <div class="form-group col-xs-6">
                    <div class="contentImage" id="contentImage">
                        <!--img class="img img-responsive" style="display:none;" id="smallImage" src="" /-->
                    </div>
                  </div>
                  <div class="clearfix"></div>
                  <textarea class="form-control" id="texta" rows="10" style="text-transform: none;"></textarea>
                  <div class="form-group col-xs-4 col-xs-offset-4 text-center">
                    <button class="btn btn-primary btn-block" id="submitFine" type="submit">
                      <img src="assets/img/save.png" width="24" />
                    </button>
                  </div>
                </div>
              </div>
            </div>
        </form>
      </div>

    </div> 

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="cordova.js" type="text/javascript"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/angular.min.js"></script>
    <script src="assets/js/snackbar.min.js"></script>
    <script src="assets/js/wizard.js"></script>
    <script src="assets/js/image.js"></script>
    <script src="assets/js/geolocation.js"></script>
    <script src="assets/js/app-api.js"></script>

    <script type="text/javascript" charset="utf-8">
      var pictureSource;   // picture source
      var destinationType; // sets the format of returned value 
      var destination = document.getElementById('contentImage');

      document.addEventListener("deviceready",onDeviceReady,false);

      function onDeviceReady() {
          pictureSource = navigator.camera.PictureSourceType;
          destinationType = navigator.camera.DestinationType;
      }

      function onPhotoDataSuccess(imageData) {

        //var smallImage = document.getElementById('smallImage');
        //smallImage.style.display = 'block';
        //smallImage.src = "data:image/jpeg;base64," + imageData;

        var img = new Image();
        img.src = "data:image/jpeg;base64," + imageData; // File contents here

        destination.appendChild(img);
      }

      function onPhotoURISuccess(imageURI) {

        //var largeImage = document.getElementById('smallImage');
        //largeImage.style.display = 'block';
        //largeImage.src = imageURI;

        var img = new Image();
        img.src = imageURI; // File contents here

        destination.appendChild(img);
      }

      function capturePhoto() {
        navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 50,
          destinationType: destinationType.DATA_URL });
      }

      function getPhoto(source) {
        navigator.camera.getPicture(onPhotoURISuccess, onFail, { 
          quality: 50, 
          destinationType: destinationType.FILE_URI,
          sourceType: source 
        });
      }

      function onFail(message) {
          $.snackbar({
            content: message, 
            timeout: 5000
          }); 
      }
    </script>

    <!--script type="text/javascript">
      var desiredWidth;
      $(document).ready(function() {
          console.log('onReady');
          $("#takePicture").on("change",gotPic);
          desiredWidth = window.innerWidth;
          if(!("url" in window) && ("webkitURL" in window)) {
            window.URL = window.webkitURL;   
          }
      });   
      function gotPic(event) {
        if(event.target.files.length >= 1 && event.target.files.length <= 4) {
          var html = '<div>';
          for(var i = 0; i < event.target.files.length; i++) {
            html += '<img class="pictureImage" src="' + event.target.files[i] + '">';
          }
          html += '</div>';
          $('.contentImage').html(html);
        } else if(event.target.files.length > 4) {
          $.snackbar({
            content: "Solamente puedes seleccionar máximo 4 imagenes.", 
            timeout: 5000
          }); 
        }
      }              
    </script-->

    <!--script type="text/javascript">
        document.getElementById('takePicture').addEventListener('change', function() {
            var file;
            var destination = document.getElementById('contentImage');
            destination.innerHTML = '';
            
            for(var x = 0, xlen = this.files.length; x < xlen; x++) {
                file = this.files[x];
                if(file.type.indexOf('image') != -1) { // Very primitive "validation"

                    var reader = new FileReader();

                    reader.onload = function(e) {
                        var img = new Image();
                        img.src = e.target.result; // File contents here

                        destination.appendChild(img);
                    };
                    
                    reader.readAsDataURL(file);
                }
            }
        });
    </script-->

    <!--script type="text/javascript">
      var images = $('.contentImage').children('div').children('img').map(function(){
          return $(this).attr('src')
      }).get();
    </script-->
    <!--script type="text/javascript">
      document.addEventListener("deviceready", onDeviceReady, false);
      function onDeviceReady() { 

        if( device.platform.toLowerCase() === 'android' && device.version.indexOf( '4.4' ) === 0 ) {
          $('#takePicture').click( function(e) {
              filechooser.open({}, success, error);
          });
        }
      }
    </script-->
    <script type="text/javascript">
      $(function (){
        $('#submitFine').on('click touch', function(event) {
          event.preventDefault();
          var def = new Array();
          var i = 0;
          var images = $('.contentImage').children('img').map(function(){
            def[i] = $(this).attr('src');
            i++;
          }).get().join(' - ');
          $('#texta').val(def);      
        });      
      });
    </script>
  </body>
</html>